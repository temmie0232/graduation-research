#1


#2
まず、本研究の動機として、事前学習の取り組みについてご説明します。 事前学習では、3つのことを行いました。 1点目は、オートエンコーダの基本構造と、「再構成誤差」を異常検知に利用する原理を学びました 。 2点目は、関連する先輩の研究を精読し、「学習識別再構成」という技術と、SVMの活用法について学びました 。 3点目は、学んだ理論をもとに、正常なデータのみでAEを学習させる、単純な異常検知プログラムを実装しました 。

#3
この事前学習のプロセスで、ある「仮説」が浮かび上がりました。 AEは、あくまで「再構成の難易度」、つまり復元のしやすさで異常を判断します 。 しかし、もし「再構成は簡単だが、そのデータのパターン自体が異常」という、「巧妙な異常」が存在した場合 、AEの「再構成誤差」という単一の視点だけでは、それを見逃してしまうのではないか、と考えました 。

#4
そこで本研究では、2つの異なる視点を組み合わせたハイブリッドモデルの構築を目的としました。 一つは、AEによる「未知のパターン」の検知 。もう一つは、SVMによる「パターンの異常性」の検知です 。 この2つを組み合わせ、AE単体では見逃してしまう異常をSVMが補完することで、より高精度な検知を実現できると期待しています。

#5
この「巧妙な異常」とは何か、分かりやすく「学校の顔パス認証システム」にたとえて説明します。 まず、AEとは、「この学校の生徒の“平均顔”を覚える」システムだとします 。 あからさまに怪しい人、例えば「宇宙人」が通れば、顔が違いすぎて復元できず、異常検知できます 。 しかし、巧妙な異常、つまり「他校の生徒」が通ったらどうでしょう 。 彼らも「学生」なので、顔のパーツは似ています。 するとAEは「うちの生徒っぽいな」と判断し、うまく復元できてしまいます 。AEは「復元のしやすさ」しか見ていないので、これを見逃してしまいます。

#6
そこで、本研究では「顔の特徴パターンの専門家（SVM）」を追加します 。 AEが「平均顔」を覚える だけでなく、SVMが「うちの生徒の“顔のクセ”」、例えば「目と鼻のバランス」といった特徴パターンを厳密に覚えます 。 これにより、「復元の難易度」と「パターンの違い」の二重でチェックする  、これが本研究の狙いです。

#7 
研究の全体像です。 ステップ1でベースラインを構築し、2でAE、3でハイブリッド化、4で最終評価を行います 。 今回ご報告するのは、ステップ1の「ベースライン構築」です 。 まず、「AE単体ではどれだけ異常を見逃すのか」をハッキリさせることが目的です。

#8
ここからが、今回実施した内容です。 データセットは、Kaggleで公開されているNSL-KDDデータセットを使用します 。 データの前処理として、文字データを数値に変換する「One-Hotエンコーディング」や、数値のスケールを0から1に揃える「Min-Maxスケーリング」 などを行いました。 ラベルは「正常」を1、「異常」を0としています 。 この結果、データは119次元の数値になりました 。

#9
次に、ベースラインとなる単純なオートエンコーダを実装しました 。 学習には「正常データのみ」を使います 。 これは、AEに「正常とは何か」だけを徹底的に学習させるためです 。 モデルの構成はスライドの通りで 、入力された119次元のデータを32次元に圧縮し、それを再び119次元に復元するものです。

#10
評価方法です。 指標は「再構成誤差」、つまり入力データと復元したデータの差、を使います 。 「正常データのみ」で学習させたモデルに、テストデータを入力します 。 この時、「正常データは誤差が小さく、異常データは誤差が大きくなるはず」というのが我々の仮説です 。 ボーダーラインとなる「閾値」は、テストデータの中の「正常データ」の誤差を分析し、その上位5%にあたる「95パーセンタイル値」に設定しました 。 この閾値を超えたら「異常」と判定します 。

#11
結果です。 まず、再構成誤差の分布をグラフで示します。

#12
こちらが誤差の分布グラフです。 横軸が「復元の失敗度合い（再構成誤差）」です。 青色（1）が「正常」データ 、赤色（0）が「異常」データ  です。
ご覧の通り、青の「正常」データは、AEが学習済みのため、復元にほぼ失敗せず、誤差「0」付近に高く集中しています 。 一方、赤の「異常」データは、AEが知らないデータのため、復元に失敗し、誤差が広範囲に分布しています。 これにより、「再構成誤差」で、ある程度は正常と異常を見分けられる、という仮説が確認できました。

#13
そして、最も注目すべきが、右上の「3028」  という数字です。 これは、「本当は異常なのに、AEが正常だと間違えて見逃してしまった」数です。

#14
これらの数値から性能を計算すると、 全体の正答率は、約84%でした 。 「正常」なデータを正しく見抜く力は95%と、非常に高いです 。 しかし、「異常」なデータを正しく見抜く力は、76%  に留まりました。

#15
考察です。 AE単体のベースラインモデルでは、正答率は約84%でした 。 そして、異常の検知率は76%でした 。 これは、裏を返せば、「異常」全体の 24% を「正常」と間違えて見逃してしまっている  ことを意味します。
あの「顔パス認証」のたとえで言えば、「他校の生徒」の4人に1人を、校内に通してしまっている状態です。 この「AEが見逃した24%の異常」の存在を、数値で明確に証明できたことが、今回の最大の成果です。

#16
次回は、この「見逃された24%を捕まえる」ため、いよいよハイブリッドモデルの構築に挑みたいと思います 。 まずは、C-2-10（C_2_10.pdf）の論文を参考に、より賢いAEの実装を進めます。