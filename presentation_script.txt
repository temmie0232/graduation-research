(スライド1: タイトル、はじめに)
---
こんにちは。本日は、研究の進捗報告をさせていただきます。
まず、本研究の目的と、これまでの歩みについて、少し詳しく振り返ります。
本研究は、オートエンコーダAEの「再構成誤差」だけでは見逃してしまう「巧妙な異常」を、SVMによる「パターン分類」を組み合わせて検知する、ハイブリッドモデルの有効性を検証することを目的としています。

これまでのステップとして、まずステップ1では、比較の基準となるベースラインモデルを構築しました。
ここでは、「正常な通信データ」のみで単純なAEを学習させ、その限界を評価しました。その結果、異常検知率は76%に留まり、異常全体の24%、数にして約3,000件もの異常通信を見逃してしまうことを定量的に確認しました。これが我々の出発点となる課題です。

次にステップ2では、この見逃しを減らすため、AE自体の性能向上に取り組みました。**先行研究（C-2-10）で示されていた**、正常・異常が混在したデータから学習できる、より賢い「学習識別再構成」、LDR-AEを実装しました。しかし、当初、評価方法がモデルに合わず性能が低下するという問題に直面しました。ですが、評価に用いる「閾値」を、統計的に最適な値を探索する「Youden's J-statistic」で決定する方法に改善したことで、異常検知率をベースラインの76%から80%まで向上させることに成功しました。
このLDR-AEの異常検知率80%という結果は、先行研究の成果と非常に近い、同程度の性能であると言えます。

しかし、AE単体の性能は向上したものの、それでもまだ異常全体の20%、数にして約2,600件を見逃しているという課題が残っています。このAEだけでは捉えきれない異常を、我々の第二の専門家であるSVMが補完的に検知できるのか？これが、今回ご報告するステップ3のメインテーマです。

(スライド2: 本日の報告内容)
---
本日は、この残された課題に挑む、ステップ3「ハイブリッドモデルの構築と最終評価」についてご報告します。
AEとSVMを連携させた本研究の最終モデルを構築し、その性能を、これまでのベースラインモデル、そしてLDR-AE単体モデルと比較・評価します。

(スライド3: Step 3 詳細)
---
それでは、ステップ3、「ハイブリッドモデルによる最終決戦」について、より詳細にご説明します。
まず手法についてです。AEが見逃す「パターンそのものの異常性」を検知するため、いよいよSVMを導入します。
実装は`train_hybrid_svm.py`で行いました。まず、ステップ2で学習させたLDR-AEのエンコーダ部分を使い、訓練データから32次元の「潜在変数」を抽出します。SVMは特徴量のスケールに敏感なため、`StandardScaler`を用いてこの潜在変数を標準化します。そして、この標準化された潜在変数を特徴量、元の正解ラベルを教師として、`SVC`、サポートベクター分類器を学習させます。その際、非線形なパターン分離を可能にする`rbf`カーネルを用い、データ数の不均衡を考慮する`class_weight='balanced'`オプションを指定しました。また、後ほどスコアを統合するため、「異常である確率」を計算できるよう`probability=True`と設定した点がポイントです。

そして、こちらが`evaluate_hybrid_model.py`に実装した、ハイブリッド判定のロジックです。
テストデータに対し、まずスコアAとしてAEによる「再構成誤差」を、スコアBとしてAEの潜在変数をSVMで分類した「異常である確率」を、それぞれ算出します。このままでは2つのスコアの尺度が異なるため、`MinMaxScaler`で0から1の範囲に正規化します。そして、正規化後の2つのスコアを単純平均し、「ハイブリッドスコア」を算出します。最後に、このハイブリッドスコアに対し、再びYouden's J-statisticで最適な閾値を決定し、最終的な異常判定を行います。

(スライド4: 最終結果)
---
それでは、最終的な評価結果をご覧ください。3つのモデルの性能を多角的に比較します。
こちらの表をご覧ください。Accuracy、正答率は、ハイブリッドモデルが約90%と最も高くなっています。そして最も重要なAnomaly Recall、異常検知率は、ベースラインの76%、LDR-AEの80%に対し、ハイブリッドモデルは92%という極めて高い性能を達成しました。F1スコアを見ても、ハイブリッドモデルが最も高いことから、バランスの取れた優れたモデルであることがわかります。
下のグラフは、異常の見逃し件数を比較したものです。ベースラインでは約3,000件だった見逃しが、LDR-AEでは約2,600件に、そしてハイブリッドモデルでは約975件と、およそ3分の1にまで劇的に削減されていることがお分かりいただけると思います。
この結果は、AEの「形状」とSVMの「パターン」という二重の視点を持つ、という本研究の仮説が、実験的に証明されたことを強く示しています。

(スライド5: まとめと今後の展望)
---
最後に、今回の成果と今後の展望です。
今回の進捗として、まず、AEの学習・評価方法を最適化し、単体性能を向上させました。そして最終的に、AEとSVMを組み合わせたハイブリッドモデルを構築し、異常検知率を92%まで大幅に向上させることに成功しました。
今後の展望としましては、まず、今回構築したハイブリッドモデルのさらなる性能向上を目指します。具体的には、現在は単純平均で統合している2つのスコアの「重み」を調整することや、SVM自体のハイパーパラメータを`GridSearchCV`などで探索・最適化することなどが考えられます。その上で、他のデータセットでもこのアプローチが有効か、検証を進めていきたいと考えています。

(スライド6: ご清聴ありがとうございました)
---
以上で本日の進捗報告を終わります。ご清聴ありがとうございました。